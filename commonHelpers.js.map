{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst formRef = document.querySelector('.search-form');\nconst containerRef = document.querySelector('.container');\nconst galleryRef = document.querySelector('.gallery');\nconst buttonRef = document.querySelector('.btn-LM');\nconst optionsSL = {\n  captions: true,\n  captionSelector: 'img',\n  captionsData: 'alt',\n  captionPosition: 'bottom',\n  animation: 250,\n};\nlet page = 1;\nlet per_page = 15;\nlet lightbox;\n\nasync function fetchImg() {\n  const params = new URLSearchParams({\n    page: page,\n    per_page: per_page,\n  });\n  const BASE_URL = 'https://pixabay.com/api/';\n  const API_KEY = '42059071-0978dc0d7158b742eee7c30f5';\n  const searchQuery = formRef.input.value;\n\n  const response = await axios.get(\n    `${BASE_URL}?key=${API_KEY}&q=${encodeURIComponent(\n      searchQuery\n    )}&image_type=photo&orientation=horizontal&safesearch=true&page=${page}&per_page=${per_page}`\n  );\n  return response.data;\n}\n\nfunction renderImg(data) {\n  const markup = data.hits\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => {\n        return `<a href=\"${largeImageURL}\" class=\"gallery-link\"><li class=\"gallery-item\">\n          <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\">\n          <p>Likes: ${likes}</p>\n          <p>Views: ${views}</p>\n          <p>Comments: ${comments}</p>\n          <p>Downloads: ${downloads}</p>\n          </li></a>`;\n      }\n    )\n    .join('');\n\n  galleryRef.insertAdjacentHTML('beforeend', markup);\n\n  lightbox.refresh();\n}\n\nformRef.addEventListener('submit', async event => {\n  event.preventDefault();\n  loaderOn();\n  page = 1;\n  galleryRef.innerHTML = '';\n\n  try {\n    const images = await fetchImg();\n    renderImg(images);\n    loaderOff();\n    showButton();\n\n    if (images.hits.length === 0) {\n      iziToast.error({\n        title: '',\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        position: 'topRight',\n      });\n\n      const { height: imageHeight } =\n        galleryRef.firstElementChild.getBoundingClientRect();\n      window.scrollBy({\n        top: imageHeight * 2,\n        behavior: 'smooth',\n      });\n    }\n  } catch (error) {\n    console.log(error);\n    hideButton();\n  }\n});\n\nbuttonRef.addEventListener('click', async () => {\n  loaderOn();\n  try {\n    page += 1;\n    const images = await fetchImg();\n    renderImg(images);\n    loaderOff();\n\n    const { height: imageHeight } =\n      galleryRef.firstElementChild.getBoundingClientRect();\n    window.scrollBy({\n      top: imageHeight * 2,\n      behavior: 'smooth',\n    });\n\n    if (galleryRef.children.length >= images.totalHits) {\n      iziToast.warning({\n        title: '',\n        message:\n          'We are sorry, but you have reached the end of search results.',\n        position: 'bottomRight',\n      });\n\n      hideButton();\n      searchQuery.reset();\n    }\n  } catch (error) {\n    console.log(error);\n    loaderOff();\n    hideButton();\n  }\n});\n\nconst showButton = () => {\n  buttonRef.style.display = 'block';\n};\n\nconst hideButton = () => {\n  buttonRef.style.display = 'none';\n};\n\nconst loaderOn = () => {\n  const loader = document.createElement('span');\n  loader.classList.add('loader');\n  containerRef.append(loader);\n};\nconst loaderOff = () => {\n  const loader = document.querySelector('.loader');\n  if (loader) {\n    loader.remove();\n  }\n};\n\nlightbox = new SimpleLightbox('.gallery a', optionsSL);\nlightbox.on('show.simplelightbox');\n"],"names":["formRef","containerRef","galleryRef","buttonRef","optionsSL","page","per_page","lightbox","fetchImg","BASE_URL","API_KEY","searchQuery","axios","renderImg","data","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","event","loaderOn","images","loaderOff","showButton","iziToast","imageHeight","error","hideButton","loader","SimpleLightbox"],"mappings":"+vBAMA,MAAMA,EAAU,SAAS,cAAc,cAAc,EAC/CC,EAAe,SAAS,cAAc,YAAY,EAClDC,EAAa,SAAS,cAAc,UAAU,EAC9CC,EAAY,SAAS,cAAc,SAAS,EAC5CC,EAAY,CAChB,SAAU,GACV,gBAAiB,MACjB,aAAc,MACd,gBAAiB,SACjB,UAAW,GACb,EACA,IAAIC,EAAO,EACPC,EAAW,GACXC,EAEJ,eAAeC,GAAW,CACT,IAAI,gBAAgB,CACjC,KAAMH,EACN,SAAUC,CACd,CAAG,EACD,MAAMG,EAAW,2BACXC,EAAU,qCACVC,EAAcX,EAAQ,MAAM,MAOlC,OALiB,MAAMY,EAAM,IAC3B,GAAGH,CAAQ,QAAQC,CAAO,MAAM,mBAC9BC,CACD,CAAA,iEAAiEN,CAAI,aAAaC,CAAQ,EAC/F,GACkB,IAClB,CAEA,SAASO,EAAUC,EAAM,CACvB,MAAMC,EAASD,EAAK,KACjB,IACC,CAAC,CACC,aAAAE,EACA,cAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CACR,IACe,YAAYL,CAAa;AAAA,4CACID,CAAY,UAAUE,CAAI;AAAA,sBAChDC,CAAK;AAAA,sBACLC,CAAK;AAAA,yBACFC,CAAQ;AAAA,0BACPC,CAAS;AAAA,oBAG9B,EACA,KAAK,EAAE,EAEVpB,EAAW,mBAAmB,YAAaa,CAAM,EAEjDR,EAAS,QAAO,CAClB,CAEAP,EAAQ,iBAAiB,SAAU,MAAMuB,GAAS,CAChDA,EAAM,eAAc,EACpBC,IACAnB,EAAO,EACPH,EAAW,UAAY,GAEvB,GAAI,CACF,MAAMuB,EAAS,MAAMjB,IAKrB,GAJAK,EAAUY,CAAM,EAChBC,IACAC,IAEIF,EAAO,KAAK,SAAW,EAAG,CAC5BG,EAAS,MAAM,CACb,MAAO,GACP,QACE,2EACF,SAAU,UAClB,CAAO,EAED,KAAM,CAAE,OAAQC,CAAa,EAC3B3B,EAAW,kBAAkB,wBAC/B,OAAO,SAAS,CACd,IAAK2B,EAAc,EACnB,SAAU,QAClB,CAAO,CACF,CACF,OAAQC,EAAO,CACd,QAAQ,IAAIA,CAAK,EACjBC,GACD,CACH,CAAC,EAED5B,EAAU,iBAAiB,QAAS,SAAY,CAC9CqB,IACA,GAAI,CACFnB,GAAQ,EACR,MAAMoB,EAAS,MAAMjB,IACrBK,EAAUY,CAAM,EAChBC,IAEA,KAAM,CAAE,OAAQG,CAAa,EAC3B3B,EAAW,kBAAkB,wBAC/B,OAAO,SAAS,CACd,IAAK2B,EAAc,EACnB,SAAU,QAChB,CAAK,EAEG3B,EAAW,SAAS,QAAUuB,EAAO,YACvCG,EAAS,QAAQ,CACf,MAAO,GACP,QACE,gEACF,SAAU,aAClB,CAAO,EAEDG,IACA,YAAY,MAAK,EAEpB,OAAQD,EAAO,CACd,QAAQ,IAAIA,CAAK,EACjBJ,IACAK,GACD,CACH,CAAC,EAED,MAAMJ,EAAa,IAAM,CACvBxB,EAAU,MAAM,QAAU,OAC5B,EAEM4B,EAAa,IAAM,CACvB5B,EAAU,MAAM,QAAU,MAC5B,EAEMqB,EAAW,IAAM,CACrB,MAAMQ,EAAS,SAAS,cAAc,MAAM,EAC5CA,EAAO,UAAU,IAAI,QAAQ,EAC7B/B,EAAa,OAAO+B,CAAM,CAC5B,EACMN,EAAY,IAAM,CACtB,MAAMM,EAAS,SAAS,cAAc,SAAS,EAC3CA,GACFA,EAAO,OAAM,CAEjB,EAEAzB,EAAW,IAAI0B,EAAe,aAAc7B,CAAS,EACrDG,EAAS,GAAG,qBAAqB"}